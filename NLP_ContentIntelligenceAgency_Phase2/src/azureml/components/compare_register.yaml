$schema: https://azuremlschemas.azureedge.net/latest/commandComponent.schema.json
name: compare_register
display_name: Compare metrics and register model
version: 0.0.8
type: command

inputs:
  new_model_dir: {type: uri_folder}
  new_metrics:   {type: uri_file}
  model_name:    {type: string}
  metric_key:    {type: string, default: f1, optional: true}
  min_improvement: {type: number, default: 0.0, optional: true}

outputs:
  deploy_flag:
    type: uri_file

environment: azureml:nlp8-env2@latest
code: ../../src
command: 
  python compare_and_register.py
    --new_model_dir ${{inputs.new_model_dir}}
    --new_metrics   ${{inputs.new_metrics}}
    --model_name    ${{inputs.model_name}}
    $[[--metric_key      ${{inputs.metric_key}}]]
    $[[--min_improvement ${{inputs.min_improvement}}]]
    --deploy_flag  ${{outputs.deploy_flag}}
